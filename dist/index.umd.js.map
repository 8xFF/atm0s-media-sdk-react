{"version":3,"file":"index.umd.js","sources":["../src/hooks/device.ts","../src/components/provider.tsx","../src/hooks/remote.ts","../src/hooks/session.ts","../src/hooks/state.ts","../src/hooks/actions.ts","../src/hooks/consumer.ts","../src/hooks/publisher.ts","../src/hooks/audio_level.ts","../src/components/video_viewer.tsx"],"sourcesContent":["import { TypedEventEmitter } from '@8xff/atm0s-media-js/types/lib/utils/typed-event-emitter';\nimport { getLogger } from '@8xff/atm0s-media-js/types/lib/utils/logger';\nimport { useEffect, useState } from 'react';\n\nconst logger = getLogger('DeviceHook');\n\ninterface Return {\n  media?: MediaStream;\n  error?: Error;\n}\n\nclass StreamContainer extends TypedEventEmitter<{ changed: (data: Return) => void }> {\n  count = 0;\n  data: Return = {};\n\n  constructor(private key: string) {\n    super();\n    logger.log('Created container for local stream', key);\n  }\n\n  setData(data: Return) {\n    this.data = data;\n    this.emit('changed', data);\n  }\n\n  retain() {\n    this.count += 1;\n    logger.log('Retain local stream', this.key, this.count);\n    return this.count;\n  }\n\n  release() {\n    this.count -= 1;\n    logger.log('Release local stream', this.key, this.count);\n    if (this.count == 0) {\n      logger.log('Destroy local stream', this.key);\n      this.data.media?.getTracks().map((track) => {\n        track.stop();\n      });\n    }\n    return this.count;\n  }\n}\nconst globalStore: Map<string, StreamContainer> = new Map();\n\nexport const useDevices = (\n  kind: MediaDeviceKind,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n): [MediaDeviceInfo[], any | null] => {\n  const [devices, setDevices] = useState<MediaDeviceInfo[]>([]);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    navigator.mediaDevices\n      .enumerateDevices()\n      .then((devices) => {\n        setDevices(devices.filter((d) => d.kind == kind));\n      })\n      .catch((error) => {\n        setDevices([]);\n        setError(error);\n      });\n  }, [kind]);\n\n  return [devices, error];\n};\n\nfunction getDevicePrivate(\n  kind: MediaDeviceKind,\n  deviceId: string | boolean,\n  callback: (data: Return) => void,\n): [StreamContainer, string] {\n  const key = kind + '-' + deviceId;\n  let containerSlot = globalStore.get(key);\n  if (containerSlot) {\n    containerSlot.on('changed', callback);\n    callback(containerSlot.data);\n  } else {\n    containerSlot = new StreamContainer(key);\n    globalStore.set(key, containerSlot);\n    let constraints: MediaStreamConstraints = {};\n    if (kind == 'audioinput') {\n      constraints = {\n        audio:\n          typeof deviceId == 'string'\n            ? {\n                deviceId: deviceId,\n              }\n            : true,\n      };\n    } else if (kind == 'videoinput') {\n      constraints = {\n        video:\n          typeof deviceId == 'string'\n            ? {\n                deviceId: deviceId,\n              }\n            : true,\n      };\n    }\n    navigator.mediaDevices\n      .getUserMedia(constraints)\n      .then((stream) => {\n        stream.cachedKey = key;\n        containerSlot?.setData({ media: stream });\n        callback({ media: stream });\n      })\n      .catch((err) => {\n        containerSlot?.setData({ error: err });\n        callback({ error: err });\n      });\n  }\n\n  return [containerSlot, key];\n}\n\nexport function getDevice(kind: MediaDeviceKind, deviceId: string | boolean): Promise<MediaStream> {\n  return new Promise((resolve, reject) => {\n    getDevicePrivate(kind, deviceId, (res) => {\n      if (res.error) {\n        reject(res.error);\n      } else {\n        resolve(res.media!);\n      }\n    });\n  });\n}\n\nexport function retainDevice(key: string) {\n  const slot = globalStore.get(key);\n  slot?.retain();\n}\n\nexport function releaseDevice(key: string) {\n  const slot = globalStore.get(key);\n  if (slot?.release() == 0) {\n    globalStore.delete(key);\n  }\n}\n\nexport const useDevice = (\n  kind: MediaDeviceKind,\n  deviceId: string | boolean,\n): [MediaStream | undefined, Error | undefined] => {\n  const [res, setRes] = useState({} as Return);\n  useEffect(() => {\n    if (deviceId != false) {\n      const [containerSlot, key] = getDevicePrivate(kind, deviceId, setRes);\n      containerSlot.retain();\n      return () => {\n        setRes({ media: undefined, error: undefined });\n        if (containerSlot?.release() == 0) {\n          globalStore.delete(key);\n        }\n      };\n    }\n  }, [kind, deviceId]);\n  return [res.media, res.error];\n};\n\nexport const useUserMedia = (\n  constraints?: MediaStreamConstraints,\n  active?: boolean,\n): [MediaStream | undefined, Error | undefined] => {\n  const [res, setRes] = useState({} as Return);\n  useEffect(() => {\n    if (active) {\n      let gotStream: MediaStream | undefined;\n      navigator.mediaDevices\n        .getUserMedia(constraints)\n        .then((stream) => {\n          gotStream = stream;\n          setRes({ media: stream });\n        })\n        .catch((err) => {\n          gotStream = undefined;\n          setRes({ error: err });\n        });\n      return () => {\n        setRes({ media: undefined, error: undefined });\n        gotStream?.getTracks().forEach((track) => {\n          track.stop();\n        });\n      };\n    }\n  }, [JSON.stringify(constraints), active]);\n  return [res.media, res.error];\n};\n\nexport const useDisplayMedia = (\n  constraints?: DisplayMediaStreamOptions,\n  active?: boolean,\n): [MediaStream | undefined, Error | undefined] => {\n  const [res, setRes] = useState({} as Return);\n  useEffect(() => {\n    if (active) {\n      let gotStream: MediaStream | undefined;\n      navigator.mediaDevices\n        .getDisplayMedia(constraints)\n        .then((stream) => {\n          gotStream = stream;\n          setRes({ media: stream });\n        })\n        .catch((err) => {\n          gotStream = undefined;\n          setRes({ error: err });\n        });\n      return () => {\n        setRes({ media: undefined, error: undefined });\n        gotStream?.getTracks().forEach((track) => {\n          track.stop();\n        });\n      };\n    }\n  }, [JSON.stringify(constraints), active]);\n  return [res.media, res.error];\n};\n","import React, { useCallback, useMemo, useState } from 'react';\nimport Atm0s, { type AnyFunction, type IPublisherCallbacks } from '@8xff/atm0s-media-js';\nimport { releaseDevice, retainDevice } from '../hooks/device';\n\nexport enum SessionState {\n  New = 'new',\n  Connecting = 'connecting',\n  Connected = 'connected',\n  Reconnecting = 'reconnecting',\n  Disconnected = 'disconnected',\n  Error = 'error',\n}\n\nexport class StreamPublisherWrap {\n  constructor(private publisher: Atm0s.StreamPublisher) {}\n\n  get state() {\n    return this.publisher.state;\n  }\n\n  get localStream() {\n    return this.publisher.localStream;\n  }\n\n  on(type: keyof IPublisherCallbacks, callback: AnyFunction) {\n    this.publisher.on(type, callback);\n  }\n\n  off(type: keyof IPublisherCallbacks, callback: AnyFunction) {\n    this.publisher.on(type, callback);\n  }\n\n  switchStream(stream: MediaStream | null) {\n    if (stream) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const cachedKey = stream.cachedKey;\n      if (cachedKey) {\n        retainDevice(cachedKey);\n      }\n    }\n    if (this.publisher.localStream) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const cacheKey = this.publisher.localStream.cachedKey;\n      if (cacheKey) {\n        releaseDevice(cacheKey);\n      }\n    }\n    return this.publisher.switch(stream);\n  }\n}\n\ninterface SessionContainer {\n  session: Atm0s.Session;\n  state: SessionState;\n  myAudioStreams: Atm0s.StreamRemote[];\n  myVideoStreams: Atm0s.StreamRemote[];\n  audioStreams: Atm0s.StreamRemote[];\n  videoStreams: Atm0s.StreamRemote[];\n  publishers: Map<string, ArcContainer<StreamPublisherWrap>>;\n  consumers: Map<string, ArcContainer<Atm0s.StreamConsumer>>;\n  consumerPairs: Map<string, ArcContainer<Atm0s.StreamConsumerPair>>;\n}\n\ninterface ArcContainer<T> {\n  data: T;\n  owners: Map<number, number>;\n}\n\ninterface SessionContextInfo {\n  data?: SessionContainer;\n  connect: (url: string, config: Atm0s.ISessionConfig) => void;\n  disconnect: () => void;\n  getPublisher(ownerId: number, cfg: Atm0s.SenderConfig): StreamPublisherWrap | undefined;\n  backPublisher(ownerId: number, cfg: Atm0s.SenderConfig): void;\n  getConsumer(ownerId: number, remote: Atm0s.StreamRemote): Atm0s.StreamConsumer | undefined;\n  backConsumer(owner_id: number, remote: Atm0s.StreamRemote): void;\n  getConsumerPair(\n    ownerId: number,\n    peerId: string,\n    audioName: string,\n    videoName: string,\n  ): Atm0s.StreamConsumerPair | undefined;\n  backConsumerPair(ownerId: number, peerId: string, audioName: string, videoName: string): void;\n  update: (new_info: SessionContainer) => void;\n}\n\nexport const SessionContext = React.createContext({} as SessionContextInfo);\n\ninterface Props {\n  children: React.ReactNode;\n  // log_level?: Atm0s.LogLevel;\n  url?: string;\n  config?: Atm0s.ISessionConfig;\n}\n\nlet GlobalVer = 0;\n\nexport const SessionProvider = (props: Props) => {\n  // if (props.log_level != undefined) {\n  //   Atm0s.setLogLevel(props.log_level);\n  // }\n  const [, setVer] = useState(0);\n  const storage = useMemo<{ data: SessionContainer | undefined }>(() => {\n    return { data: undefined };\n  }, []);\n  const update = useCallback(\n    (data: SessionContainer | undefined) => {\n      storage.data = data;\n      setVer(GlobalVer++);\n    },\n    [storage, setVer],\n  );\n  const connect = useCallback(\n    (url: string, config: Atm0s.ISessionConfig) => {\n      if (storage.data?.session) {\n        return () => {\n          storage.data?.session.disconnect();\n        };\n      }\n      const session = Atm0s.createSession(url, config);\n      const myAudioStreams = new Map<string, Atm0s.StreamRemote>();\n      const myVideoStreams = new Map<string, Atm0s.StreamRemote>();\n      const audioStreams = new Map<string, Atm0s.StreamRemote>();\n      const videoStreams = new Map<string, Atm0s.StreamRemote>();\n\n      const publishers: Map<string, ArcContainer<StreamPublisherWrap>> = new Map();\n      const consumers: Map<string, ArcContainer<Atm0s.StreamConsumer>> = new Map();\n      const consumerPairs: Map<string, ArcContainer<Atm0s.StreamConsumerPair>> = new Map();\n\n      config?.senders?.map((sender) => {\n        if (sender.stream) {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          const cachedKey = sender.stream.cachedKey;\n          if (cachedKey) {\n            retainDevice(cachedKey);\n          }\n        }\n      });\n\n      session.on('connected', () => {\n        if (storage.data?.session != session) return;\n        update({\n          session,\n          state: SessionState.Connected,\n          myAudioStreams: Array.from(myAudioStreams.values()),\n          myVideoStreams: Array.from(myVideoStreams.values()),\n          audioStreams: Array.from(audioStreams.values()),\n          videoStreams: Array.from(videoStreams.values()),\n          publishers,\n          consumers,\n          consumerPairs,\n        });\n      });\n\n      session.on('mystream_added', (stream: Atm0s.StreamRemote) => {\n        if (storage.data?.session != session) return;\n        const key = stream.peerId + '-' + stream.name;\n        if (stream.kind === Atm0s.StreamKinds.AUDIO) {\n          myAudioStreams.set(key, stream);\n        } else {\n          myVideoStreams.set(key, stream);\n        }\n        update({\n          session,\n          state: SessionState.Connected,\n          myAudioStreams: Array.from(myAudioStreams.values()),\n          myVideoStreams: Array.from(myVideoStreams.values()),\n          audioStreams: Array.from(audioStreams.values()),\n          videoStreams: Array.from(videoStreams.values()),\n          publishers,\n          consumers,\n          consumerPairs,\n        });\n      });\n\n      session.on('mystream_updated', (stream: Atm0s.StreamRemote) => {\n        if (storage.data?.session != session) return;\n        const key = stream.peerId + '-' + stream.name;\n        if (stream.kind === Atm0s.StreamKinds.AUDIO) {\n          myAudioStreams.set(key, stream);\n        } else {\n          myVideoStreams.set(key, stream);\n        }\n        update({\n          session,\n          state: SessionState.Connected,\n          myAudioStreams: Array.from(myAudioStreams.values()),\n          myVideoStreams: Array.from(myVideoStreams.values()),\n          audioStreams: Array.from(audioStreams.values()),\n          videoStreams: Array.from(videoStreams.values()),\n          publishers,\n          consumers,\n          consumerPairs,\n        });\n      });\n\n      session.on('mystream_removed', (stream: Atm0s.StreamRemote) => {\n        if (storage.data?.session != session) return;\n        const key = stream.peerId + '-' + stream.name;\n        if (stream.kind === Atm0s.StreamKinds.AUDIO) {\n          myAudioStreams.delete(key);\n        } else {\n          myVideoStreams.delete(key);\n        }\n        update({\n          session,\n          state: SessionState.Connected,\n          myAudioStreams: Array.from(myAudioStreams.values()),\n          myVideoStreams: Array.from(myVideoStreams.values()),\n          audioStreams: Array.from(audioStreams.values()),\n          videoStreams: Array.from(videoStreams.values()),\n          publishers,\n          consumers,\n          consumerPairs,\n        });\n      });\n\n      session.on('stream_added', (stream: Atm0s.StreamRemote) => {\n        if (storage.data?.session != session) return;\n        const key = stream.peerId + '-' + stream.name;\n        if (stream.kind === Atm0s.StreamKinds.AUDIO) {\n          audioStreams.set(key, stream);\n        } else {\n          videoStreams.set(key, stream);\n        }\n        update({\n          session,\n          state: SessionState.Connected,\n          myAudioStreams: Array.from(myAudioStreams.values()),\n          myVideoStreams: Array.from(myVideoStreams.values()),\n          audioStreams: Array.from(audioStreams.values()),\n          videoStreams: Array.from(videoStreams.values()),\n          publishers,\n          consumers,\n          consumerPairs: consumerPairs,\n        });\n      });\n\n      session.on('stream_updated', (stream: Atm0s.StreamRemote) => {\n        if (storage.data?.session != session) return;\n        const key = stream.peerId + '-' + stream.name;\n        if (stream.kind === Atm0s.StreamKinds.AUDIO) {\n          audioStreams.set(key, stream);\n        } else {\n          videoStreams.set(key, stream);\n        }\n        update({\n          session,\n          state: SessionState.Connected,\n          myAudioStreams: Array.from(myAudioStreams.values()),\n          myVideoStreams: Array.from(myVideoStreams.values()),\n          audioStreams: Array.from(audioStreams.values()),\n          videoStreams: Array.from(videoStreams.values()),\n          publishers,\n          consumers,\n          consumerPairs,\n        });\n      });\n\n      session.on('stream_removed', (stream: Atm0s.StreamRemote) => {\n        if (storage.data?.session != session) return;\n        const key = stream.peerId + '-' + stream.name;\n        if (stream.kind === Atm0s.StreamKinds.AUDIO) {\n          audioStreams.delete(key);\n        } else {\n          videoStreams.delete(key);\n        }\n        update({\n          session,\n          state: SessionState.Connected,\n          myAudioStreams: Array.from(myAudioStreams.values()),\n          myVideoStreams: Array.from(myVideoStreams.values()),\n          audioStreams: Array.from(audioStreams.values()),\n          videoStreams: Array.from(videoStreams.values()),\n          publishers,\n          consumers,\n          consumerPairs,\n        });\n      });\n\n      session.on('disconnected', () => {\n        if (storage.data?.session != session) return;\n        update({\n          session,\n          state: SessionState.Disconnected,\n          myAudioStreams: Array.from(myAudioStreams.values()),\n          myVideoStreams: Array.from(myVideoStreams.values()),\n          audioStreams: Array.from(audioStreams.values()),\n          videoStreams: Array.from(videoStreams.values()),\n          publishers,\n          consumers,\n          consumerPairs,\n        });\n      });\n      session.connect().catch((err) => {\n        if (storage.data?.session != session) return;\n        console.error(err);\n        update({\n          session,\n          state: SessionState.Error,\n          myAudioStreams: Array.from(myAudioStreams.values()),\n          myVideoStreams: Array.from(myVideoStreams.values()),\n          audioStreams: Array.from(audioStreams.values()),\n          videoStreams: Array.from(videoStreams.values()),\n          publishers,\n          consumers,\n          consumerPairs,\n        });\n      });\n      update({\n        session,\n        state: SessionState.Connecting,\n        myAudioStreams: [],\n        myVideoStreams: [],\n        audioStreams: [],\n        videoStreams: [],\n        publishers,\n        consumers,\n        consumerPairs,\n      });\n      return;\n    },\n    [storage, update],\n  );\n\n  const disconnect = useCallback(() => {\n    if (storage.data?.session) {\n      storage.data.session.disconnect();\n      update(undefined);\n    }\n  }, [storage, update]);\n\n  const getPublisher = useCallback(\n    (ownerId: number, cfg: Atm0s.SenderConfig) => {\n      const data = storage.data;\n      if (data?.session) {\n        let publisher = data.publishers.get(cfg.name);\n        if (!publisher) {\n          publisher = {\n            data: new StreamPublisherWrap(\n              data.session.createPublisher({\n                stream: cfg.stream,\n                name: cfg.name,\n                kind: cfg.kind,\n                preferredCodecs: cfg.preferredCodecs,\n                simulcast: cfg.simulcast,\n                maxBitrate: cfg.maxBitrate,\n                contentHint: cfg.contentHint,\n                screen: cfg.screen,\n              }),\n            ),\n            owners: new Map(),\n          };\n          data.publishers.set(cfg.name, publisher);\n        }\n        data.publishers.get(cfg.name)?.owners.set(ownerId, new Date().getTime());\n        return publisher.data;\n      }\n      return undefined;\n    },\n    [storage],\n  );\n\n  const backPublisher = useCallback(\n    (ownerId: number, cfg: Atm0s.SenderConfig) => {\n      const data = storage.data;\n      if (data?.session) {\n        const publisher = data.publishers.get(cfg.name);\n        if (publisher) {\n          publisher.owners.delete(ownerId);\n          if (publisher.owners.size == 0) {\n            publisher.data.switchStream(null);\n            data.publishers.delete(cfg.name);\n          }\n        }\n      }\n      return undefined;\n    },\n    [storage],\n  );\n\n  const getConsumer = useCallback(\n    (ownerId: number, stream: Atm0s.StreamRemote) => {\n      const data = storage.data;\n      if (data?.session) {\n        const key = stream.peerId + '-' + stream.name;\n        let consumer = data.consumers.get(key);\n        if (!consumer) {\n          consumer = {\n            data: data.session.createConsumer(stream),\n            owners: new Map(),\n          };\n          data.consumers.set(key, consumer);\n        }\n        data.consumers.get(key)?.owners.set(ownerId, new Date().getTime());\n        return consumer.data;\n      }\n      return undefined;\n    },\n    [storage],\n  );\n\n  const backConsumer = useCallback(\n    (ownerId: number, stream: Atm0s.StreamRemote) => {\n      const data = storage.data;\n      if (data?.session) {\n        const key = stream.peerId + '-' + stream.name;\n        const consumer = data.consumers.get(key);\n        if (consumer) {\n          consumer.owners.delete(ownerId);\n          if (consumer.owners.size == 0) {\n            data.consumers.delete(key);\n          }\n        }\n      }\n      return undefined;\n    },\n    [storage],\n  );\n\n  const getConsumerPair = useCallback(\n    (ownerId: number, peerId: string, audioName: string, videoName: string) => {\n      const data = storage.data;\n      if (data?.session) {\n        const key = peerId + '-' + audioName + '-' + videoName;\n        let consumer = data.consumerPairs.get(key);\n        if (!consumer) {\n          consumer = {\n            data: data.session.createConsumerPair(peerId, audioName, videoName),\n            owners: new Map(),\n          };\n          data.consumerPairs.set(key, consumer);\n        }\n        data.consumerPairs.get(key)?.owners.set(ownerId, new Date().getTime());\n        return consumer.data;\n      }\n      return undefined;\n    },\n    [storage],\n  );\n\n  const backConsumerPair = useCallback(\n    (ownerId: number, peerId: string, audioName: string, videoName: string) => {\n      const data = storage.data;\n      if (data?.session) {\n        const key = peerId + '-' + audioName + '-' + videoName;\n        const consumer = data.consumerPairs.get(key);\n        if (consumer) {\n          consumer.owners.delete(ownerId);\n          if (consumer.owners.size == 0) {\n            data.consumerPairs.delete(key);\n          }\n        }\n      }\n      return undefined;\n    },\n    [storage],\n  );\n\n  React.useEffect(() => {\n    if (props.url && props.config) {\n      connect(props.url, props.config);\n      return () => {\n        disconnect();\n      };\n    }\n  }, [props.url, props.config, connect, disconnect]);\n\n  return (\n    <SessionContext.Provider\n      value={{\n        data: storage.data,\n        connect,\n        disconnect,\n        getPublisher: getPublisher,\n        backPublisher: backPublisher,\n        getConsumer: getConsumer,\n        backConsumer: backConsumer,\n        getConsumerPair: getConsumerPair,\n        backConsumerPair: backConsumerPair,\n        update,\n      }}>\n      {props.children}\n    </SessionContext.Provider>\n  );\n};\n","import { useContext } from 'react';\nimport { SessionContext } from '../components/provider';\nimport Atm0s from '@8xff/atm0s-media-js';\n\nexport const useRemoteStreams = (kind: Atm0s.StreamKinds, isMine?: boolean): Atm0s.StreamRemote[] => {\n  const { data } = useContext(SessionContext);\n  if (kind == Atm0s.StreamKinds.AUDIO) {\n    if (isMine === true) {\n      return data?.myAudioStreams || [];\n    } else {\n      return data?.audioStreams || [];\n    }\n  } else {\n    if (isMine === true) {\n      return data?.myVideoStreams || [];\n    } else {\n      return data?.videoStreams || [];\n    }\n  }\n};\n\nexport const usePeerRemoteStreams = (peerId: string, kind: Atm0s.StreamKinds): Atm0s.StreamRemote[] => {\n  const { data } = useContext(SessionContext);\n  if (kind == Atm0s.StreamKinds.AUDIO) {\n    return data?.audioStreams.filter((a) => a.peerId === peerId) || [];\n  } else {\n    return data?.videoStreams.filter((a) => a.peerId === peerId) || [];\n  }\n};\n","import { useContext } from 'react';\nimport { SessionContext } from '../components/provider';\nimport Atm0s from '@8xff/atm0s-media-js';\n\nexport const useSession = (): Atm0s.Session | undefined => {\n  const { data } = useContext(SessionContext);\n  return data?.session;\n};\n","import { useContext } from 'react';\nimport { SessionContext, SessionState } from '../components/provider';\n\nexport const useSessionState = (): SessionState => {\n  const { data } = useContext(SessionContext);\n  return data?.state || SessionState.New;\n};\n","import { useContext } from 'react';\nimport { SessionContext } from '../components/provider';\nimport type { ISessionConfig } from '@8xff/atm0s-media-js';\n\ninterface Actions {\n  connect: (url: string, config: ISessionConfig) => void;\n  disconnect: () => void;\n  playAudioMix: () => void;\n}\n\nexport const useActions = (): Actions => {\n  const { connect, disconnect } = useContext(SessionContext);\n  return {\n    connect,\n    disconnect,\n    playAudioMix: () => {\n      // data?.session.getMixMinusAudio()?.play();\n    },\n  };\n};\n","import { useContext, useEffect, useMemo, useState, type LegacyRef } from 'react';\nimport { SessionContext, SessionState } from '../components/provider';\nimport Atm0s from '@8xff/atm0s-media-js';\nimport { useSessionState } from './state';\n\nlet idSeed = 0;\nexport const useConsumer = (\n  remote?: Atm0s.StreamRemote,\n  priority?: number,\n  maxSpatial?: number,\n  maxTemporal?: number,\n): [LegacyRef<HTMLVideoElement> | undefined, Atm0s.StreamReceiverState, Atm0s.StreamConsumer | undefined] => {\n  const consumerId = useMemo(() => idSeed++, []);\n  const sessionState = useSessionState();\n  const [consumer, setConsumer] = useState<Atm0s.StreamConsumer>();\n  const [state, setState] = useState<Atm0s.StreamReceiverState>(Atm0s.StreamReceiverState.NoSource);\n  const [element, setElement] = useState<HTMLVideoElement>();\n  const { data, getConsumer, backConsumer } = useContext(SessionContext);\n\n  const isConnectionEstablished = [SessionState.Connected, SessionState.Reconnecting].indexOf(sessionState) >= 0;\n\n  useEffect(() => {\n    if (data?.session && remote) {\n      const consumer = getConsumer(consumerId, remote);\n      if (consumer) {\n        consumer.on('state', setState);\n        setState(consumer.state);\n        setConsumer(consumer);\n        return () => {\n          consumer?.unview('use-consumer-' + consumerId);\n          consumer?.off('state', setState);\n          backConsumer(consumerId, remote);\n        };\n      }\n    }\n  }, [data?.session, remote]);\n\n  useEffect(() => {\n    if (element && consumer && isConnectionEstablished) {\n      element.srcObject = consumer.view('use-consumer-' + consumerId, priority, maxSpatial, maxTemporal);\n      return () => {\n        element.srcObject = null;\n        consumer.unview('use-consumer-' + consumerId);\n      };\n    }\n  }, [element, consumer, isConnectionEstablished]);\n\n  useEffect(() => {\n    if (element && consumer && isConnectionEstablished) {\n      consumer.limit('use-consumer-' + consumerId, priority, maxSpatial, maxTemporal);\n    }\n  }, [element, consumer, isConnectionEstablished, priority, maxSpatial, maxTemporal]);\n\n  const ref = (instance: HTMLVideoElement | null) => {\n    setElement(instance || undefined);\n  };\n\n  return [ref, state, consumer];\n};\n\nexport const useConsumerPair = (\n  peerId: string,\n  audioName: string,\n  videoName: string,\n  priority?: number,\n  maxSpatial?: number,\n  maxTemporal?: number,\n): [LegacyRef<HTMLVideoElement> | undefined, Atm0s.StreamReceiverState, Atm0s.StreamConsumerPair | undefined] => {\n  const consumerId = useMemo(() => idSeed++, []);\n  const sessionState = useSessionState();\n  const [consumer, setConsumer] = useState<Atm0s.StreamConsumerPair>();\n  const [state, setState] = useState<Atm0s.StreamReceiverState>(Atm0s.StreamReceiverState.NoSource);\n  const [element, setElement] = useState<HTMLVideoElement>();\n  const { data, getConsumerPair: getConsumerPair, backConsumerPair: backConsumerPair } = useContext(SessionContext);\n\n  const isConnectionEstablished = [SessionState.Connected, SessionState.Reconnecting].indexOf(sessionState) >= 0;\n\n  useEffect(() => {\n    if (data?.session) {\n      const consumer = getConsumerPair(consumerId, peerId, audioName, videoName);\n      if (consumer) {\n        consumer.on('state', setState);\n        setState(consumer.state);\n        setConsumer(consumer);\n        return () => {\n          consumer?.off('state', setState);\n          backConsumerPair(consumerId, peerId, audioName, videoName);\n        };\n      }\n    }\n  }, [data?.session, peerId, audioName, videoName]);\n\n  useEffect(() => {\n    if (element && consumer && isConnectionEstablished) {\n      element.srcObject = consumer.view('use-consumer-' + consumerId, priority, maxSpatial, maxTemporal);\n      return () => {\n        element.srcObject = null;\n        consumer.unview('use-consumer-' + consumerId);\n      };\n    }\n  }, [element, consumer, isConnectionEstablished]);\n\n  useEffect(() => {\n    if (element && consumer && isConnectionEstablished) {\n      consumer.limit('use-consumer-' + consumerId, priority, maxSpatial, maxTemporal);\n    }\n  }, [element, consumer, isConnectionEstablished, priority, maxSpatial, maxTemporal]);\n\n  const ref = (instance: HTMLVideoElement | null) => {\n    setElement(instance || undefined);\n  };\n\n  return [ref, state, consumer];\n};\n\nexport const useLocalConsumer = (stream?: MediaStream) => {\n  const [element, setElement] = useState<HTMLVideoElement>();\n  useEffect(() => {\n    if (element && stream) {\n      element.srcObject = stream;\n      return () => {\n        element.srcObject = null;\n      };\n    }\n  }, [element, stream]);\n\n  return (instance: HTMLVideoElement | null) => {\n    setElement(instance || undefined);\n  };\n};\n","import { useContext, useEffect, useMemo, useState } from 'react';\nimport { SessionContext, StreamPublisherWrap } from '../components/provider';\nimport Atm0s from '@8xff/atm0s-media-js';\n\nlet idSeed = 0;\n\nexport const usePublisher = (\n  cfg: Atm0s.SenderConfig,\n): [Atm0s.StreamSenderState, MediaStream | undefined | null, StreamPublisherWrap | undefined] => {\n  const publisherId = useMemo(() => idSeed++, []);\n  const [state, setState] = useState<Atm0s.StreamSenderState>(Atm0s.StreamSenderState.Created);\n  const [producer, setProducer] = useState<StreamPublisherWrap>();\n  const { data, getPublisher: getPublisher, backPublisher: backPublisher } = useContext(SessionContext);\n  useEffect(() => {\n    if (data?.session) {\n      const newProducer = getPublisher(publisherId, cfg);\n      if (newProducer) {\n        const onUpdateState = (state: Atm0s.StreamSenderState) => {\n          setState(state);\n        };\n        newProducer.on('state', onUpdateState);\n        setProducer(newProducer);\n        setState(newProducer.state);\n        return () => {\n          newProducer?.off('state', onUpdateState);\n          backPublisher(publisherId, cfg);\n        };\n      }\n    }\n  }, [data?.session, cfg.kind + cfg.name]);\n\n  return [state, producer?.localStream, producer];\n};\n","import { useContext, useEffect, useState } from 'react';\nimport * as Bluesea from '@8xff/atm0s-media-js';\nimport { StreamPublisherWrap, BlueseaSessionContext } from '../components';\n\nexport const useAudioLevelConsumer = (\n  consumer?: Bluesea.StreamConsumer | Bluesea.StreamConsumerPair,\n): number | undefined => {\n  const [audioLevel, setAudioLevel] = useState<number | undefined>(undefined);\n  useEffect(() => {\n    if (consumer) {\n      const handler = (level: number) => {\n        setAudioLevel(level);\n      };\n      consumer.on('audio_level', handler);\n\n      return () => {\n        consumer.off('audio_level', handler);\n      };\n    } else {\n      setAudioLevel(undefined);\n    }\n  }, [consumer]);\n  return audioLevel;\n};\n\nexport const useAudioLevelProducer = (producer?: StreamPublisherWrap): number | undefined => {\n  const [audioLevel, setAudioLevel] = useState<number | undefined>(undefined);\n  useEffect(() => {\n    if (producer) {\n      const handler = (level: number) => {\n        setAudioLevel(level);\n      };\n      producer.on('audio_level', handler);\n\n      return () => {\n        producer.off('audio_level', handler);\n      };\n    } else {\n      setAudioLevel(undefined);\n    }\n  }, [producer]);\n  return audioLevel;\n};\n\nexport interface AudioMixSlotInfo {\n  peerId: string;\n  streamName: string;\n  audioLevel: number;\n}\n\nexport const useAudioSlotMix = (slotIndex: number) => {\n  const [slot, setSlot] = useState<AudioMixSlotInfo | undefined>(undefined);\n  const { data } = useContext(BlueseaSessionContext);\n  useEffect(() => {\n    const mixMinus = data?.session.getMixMinusAudio();\n    if (mixMinus) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const handler = (info: any | null) => {\n        if (info) {\n          const sourceId = info[0].split(':');\n          setSlot({\n            peerId: sourceId[0],\n            streamName: sourceId[1],\n            audioLevel: info[1],\n          });\n        } else {\n          setSlot(undefined);\n        }\n      };\n      mixMinus.on(`slot_${slotIndex}`, handler);\n\n      return () => {\n        mixMinus?.off(`slot_${slotIndex}`, handler);\n      };\n    }\n  }, [slotIndex, data?.session.getMixMinusAudio()]);\n  return slot;\n};\n\nexport const useAudioLevelMix = (peerId: string, streamName: string) => {\n  const [audioLevel, setAudioLevel] = useState<number | undefined>(undefined);\n  const { data } = useContext(BlueseaSessionContext);\n  useEffect(() => {\n    const mixMinus = data?.session.getMixMinusAudio();\n    if (mixMinus) {\n      const handler = (level: number | null) => {\n        setAudioLevel(level || undefined);\n      };\n      mixMinus.on(`source_${peerId}:${streamName}`, handler);\n\n      return () => {\n        mixMinus?.off(`source_${peerId}:${streamName}`, handler);\n      };\n    }\n  }, [peerId, streamName, data?.session.getMixMinusAudio()]);\n  return audioLevel;\n};\n","import { StreamRemote } from '@8xff/atm0s-media-js';\nimport React from 'react';\nimport { useConsumer, useLocalConsumer } from '../hooks';\n\nexport const RemoteViewer = (props: { remote: StreamRemote; priority?: number }) => {\n  const [ref, state] = useConsumer(props.remote, props.priority);\n  return (\n    <div className=\"w-full h-full\">\n      <div>{state}</div>\n      <video muted autoPlay className=\"w-full h-full\" ref={ref}></video>\n    </div>\n  );\n};\n\nexport const LocalViewer = (props: { stream: MediaStream }) => {\n  const ref = useLocalConsumer(props.stream);\n  return <video muted autoPlay className=\"w-full h-full\" ref={ref}></video>;\n};\n\nexport const VideoViewer = (props: { stream: MediaStream | StreamRemote; priority?: number }) => {\n  if (props.stream instanceof StreamRemote) {\n    return <RemoteViewer remote={props.stream} priority={props.priority}></RemoteViewer>;\n  } else {\n    return <LocalViewer stream={props.stream}></LocalViewer>;\n  }\n};\n"],"names":["getLogger","TypedEventEmitter","useState","useEffect","SessionState","useMemo","useCallback","useContext","idSeed","BlueseaSessionContext","StreamRemote"],"mappings":"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"}